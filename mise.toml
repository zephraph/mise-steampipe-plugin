[env]
MISE_USE_VERSIONS_HOST = "0"

[tools]
actionlint = "latest"
lefthook = "1.13.0"
lua = "5.4"
"ubi:turbot/steampipe" = "2.3.2"
stylua = "latest"

[settings]
experimental = true

[tasks.format]
description = "Format Lua scripts"
run = "stylua metadata.lua hooks/"

[tasks.check]
description = "Check Lua scripts and GitHub Actions"
run = """
luarocks install luacheck --local || true
~/.luarocks/bin/luacheck metadata.lua hooks/
stylua --check metadata.lua hooks/
actionlint .github/workflows/*.yml .github/workflows/*.yaml 2>/dev/null || true
"""

[tasks.fix]
description = "Fix and format all code"
run = """
luarocks install luacheck --local || true
~/.luarocks/bin/luacheck metadata.lua hooks/
stylua metadata.lua hooks/
"""

[tasks.lint]
description = "Alias for check task"
depends = ["check"]

[tasks.ci]
description = "Run all CI checks"
depends = ["lint", "test"]
